<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Hello, World! - A-Frame</title>
    <meta name="description" content="Hello, World! - A-Frame">
    <script type="text/javascript" src="assets/js/aframe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/nunjucks/2.3.0/nunjucks.min.js"></script>
    <script src="https://rawgit.com/ngokevin/aframe-layout-component/master/dist/aframe-layout-component.min.js"></script>
    <script src="assets/js/template-component.js"></script>
    <script type="text/javascript" src="assets/js/entity.js"></script>
    <script type="text/javascript" src="assets/js/three.js"></script>
      <script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
  </head>
  <body>

      <a-scene>
        <a-assets>
          <img id="enemy-sprite" crossorigin="" src="assets/img/cat.png" class="cat-img">
          <img id="grass" src="assets/img/grass.jpg">
          <a-asset-item id="tree-obj" src="assets/img/tree.obj"></a-asset-item>
          <a-asset-item id="tree-mtl" src="assets/img/tree.mtl"></a-asset-item>
          <audio id="bg-music" loop src="/assets/audio/%E3%83%8F%E3%83%AD%EF%BC%8F%E3%83%8F%E3%83%AF%E3%83%A6%20%28Hello%252FHow%20are%20you%29%20-%208%20Bit.mp3"></audio>

          <script id="enemies" type="text/x-nunjucks-template">
            <a-entity layout="type: circle; radius: 5" position="0 0.5 0">
              <a-animation attribute="rotation" dur="30000" easing="linear" repeat="indefinite" to="0 360 0"></a-animation>
              {% for x in range(num) %}
                <a-image class="enemy" look-at="#player" src="#enemy-sprite" transparent="true">
                  <!-- Attach collision handler animations. -->
                  <a-animation attribute="opacity" begin="collider-hit" dur="800"
                               ease="linear" from="1" to="0"></a-animation>
                  <a-animation attribute="scale" begin="collider-hit" dur="400"
                               ease="linear" to="0 0 0"></a-animation>
                </a-image>
              {% endfor %}
            </a-entity>
          </script>

          <!-- Attach collider to laser. -->
          <a-mixin id="laser"
                   geometry="primitive: cylinder; radius: 0.05; translate: 0 -2 0"
                   material="color: green; metalness: 0.2; opacity: 0.4; roughness: 0.3"
                   rotation="90 0 0" projectile collider="target: .enemy"></a-mixin>
        </a-assets>

        <a-entity template="src: #enemies" data-num="10" click-listener></a-entity>

        <a-camera id="player" position="0 1.8 0" spawner="mixin: laser; on: click" click-listener>

        </a-camera>
        <a-entity obj-model="obj: #tree-obj; mtl: #tree-mtl" position="-1 1 -3" scale=".5 .5 .5"></a-entity>
        <a-entity obj-model="obj: #tree-obj; mtl: #tree-mtl" position="5 1 -3" scale=".5 .5 .5"></a-entity>
        <a-entity obj-model="obj: #tree-obj; mtl: #tree-mtl" position="-1.2 1 3" scale=".5 .5 .5"></a-entity>
        <a-entity obj-model="obj: #tree-obj; mtl: #tree-mtl" position="1.4 1 -1" scale=".5 .5 .5"></a-entity>
        <a-entity obj-model="obj: #tree-obj; mtl: #tree-mtl" position="-1 1 -3" scale=".5 .5 .5"></a-entity>
        <a-entity obj-model="obj: #tree-obj; mtl: #tree-mtl" position="-5 1.2 -3" scale=".3 .3 .3"></a-entity>
        <a-entity obj-model="obj: #tree-obj; mtl: #tree-mtl" position="-1 1 -3" scale=".5 .5 .5"></a-entity>

        <a-sky src="#grass"></a-sky>
      </a-scene>

  </body>
</html>
